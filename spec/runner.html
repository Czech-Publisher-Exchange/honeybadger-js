<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Jasmine Spec Runner</title>

  <link rel="shortcut icon" type="image/png" href="../vendor/jasmine-2.4.1/jasmine_favicon.png">
  <link rel="stylesheet" type="text/css" href="../vendor/jasmine-2.4.1/jasmine.css">
  <script type="text/javascript" src="../vendor/jasmine-2.4.1/jasmine.js"></script>
  <script type="text/javascript" src="../vendor/jasmine-2.4.1/jasmine-html.js"></script>
  <script type="text/javascript" src="../vendor/jasmine-2.4.1/boot.js"></script>
  <script type="text/javascript" src="../vendor/jasmine-jsreporter-1.0.0/jasmine-jsreporter.js"></script>

  <!-- include source files here... -->
  <script type="text/javascript" src="../build/src/helpers.js"></script>
  <script type="text/javascript" src="../build/src/configuration.js"></script>
  <script type="text/javascript" src="../build/src/notice.js"></script>
  <script type="text/javascript" src="../build/src/honeybadger.js"></script>
  <script type="text/javascript" src="../src/instrumentation.js"></script>

  <!-- include spec files here... -->
  <script type="text/javascript" src="../build/spec/notice.spec.js"></script>
  <script type="text/javascript" src="../build/spec/configuration.spec.js"></script>
  <script type="text/javascript" src="../build/spec/honeybadger.spec.js"></script>
  <script>
    jasmine.getEnv().addReporter(new jasmine.JSReporter2());

    // Thanks @gordonwoodhull https://github.com/axemclion/grunt-saucelabs/issues/109#issuecomment-166767282
    (function () {
      var oldJSReport = window.jasmine.getJSReport;
      window.jasmine.getJSReport = function () {
        var results = oldJSReport();
        if (results) {
          return {
            durationSec: results.durationSec,
            suites: removePassingTests(results.suites),
            passed: results.passed
          };
        } else {
          return null;
        }
      };

      function removePassingTests (suites) {
        return suites.filter(specFailed)
          .map(mapSuite);
      }

      function mapSuite (suite) {
        var result = {};
        for (var s in suite) {
          result[s] = suite[s];
        }
        result.specs = suite.specs.filter(specFailed);
        result.suites = removePassingTests(suite.suites);
        return result;
      }

      function specFailed (item) {
        return !item.passed;
      }
    })();
  </script>
</head>

<body>
</body>
</html>
